# 中英文单词本 Chrome 插件

一个功能丰富的Chrome浏览器插件，支持中英文词汇学习、划词翻译、生词表管理、音频发音和Anki同步功能。

## 功能特点

- 🌐 **划词翻译**：选中英文单词或短语，点击翻译按钮即可显示中文翻译
- 📝 **英文例句**：显示单词在实际语境中的使用方法，帮助学习
- 🔤 **中文例句**：提供对应的中文翻译，便于理解
- 🔊 **语音朗读**：支持英文单词的语音朗读功能
- ⭐ **生词表**：收藏不熟悉的单词，方便复习和管理
- 📤 **Anki导出**：将生词表导出为CSV格式，可直接导入Anki进行记忆训练
- 🎵 **Anki音频卡片**：生成的Anki卡片包含中英文发音，支持自动播放和点击播放
- 🤖 **多翻译源**：支持OpenAI、Google等多种翻译服务
- ⚡ **快速响应**：本地缓存翻译结果，提高响应速度
- 🎯 **智能识别**：自动识别英文单词，过滤无关内容
- 🎨 **美观界面**：简洁现代的用户界面设计
- ⚙️ **个性设置**：可自定义启用状态和自动发音

## 安装方法

### 开发者模式安装

1. 下载或克隆此项目到本地
2. 打开Chrome浏览器，进入扩展程序页面（chrome://extensions/）
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择项目文件夹
6. 插件安装完成！

## 使用方法

### 基本翻译
1. **选中文本**：用鼠标选中要翻译的英文单词或短语
2. **点击翻译**：点击出现的蓝色🌐翻译按钮
3. **查看结果**：在弹出的翻译窗口中查看：
   - 单词释义和发音
   - 📝 英文例句（绿色显示）
   - 🔤 中文例句（灰色显示）
   - 同义词和常用短语
4. **听取发音**：点击🔊按钮听取单词发音
5. **学习用法**：通过英文例句学习单词的实际使用方法

### 生词表功能
1. **添加生词**：在翻译弹窗中点击⭐按钮将单词添加到生词表
2. **管理生词**：点击扩展图标，切换到"生词表"标签页
3. **复习生词**：在生词表中可以重新听发音或删除不需要的单词
4. **导出Anki**：点击"📤 Anki"按钮将生词表导出为CSV格式
5. **清空生词**：点击"清空"按钮可以删除所有生词

### Anki环境配置

#### 1. 安装Anki软件
- **桌面版**：访问 [Anki官网](https://apps.ankiweb.net/) 下载适合您操作系统的版本
- **移动版**：
  - Android：在Google Play商店搜索"AnkiDroid"（免费）
  - iOS：在App Store搜索"AnkiMobile Flashcards"（付费）

#### 2. 安装AnkiConnect插件
为了实现浏览器插件与Anki的直接同步，需要安装AnkiConnect插件：

1. **打开Anki软件**
2. **安装插件**：
   - 点击菜单栏"工具" → "插件"
   - 点击"获取插件"按钮
   - 输入插件代码：`2055492159`
   - 点击"确定"下载并安装
3. **重启Anki**：安装完成后重启Anki软件
4. **验证安装**：重启后AnkiConnect会自动在后台运行（默认端口8765）

#### 3. 配置AnkiConnect
- AnkiConnect默认配置通常无需修改
- 如需自定义，可在Anki的"工具" → "插件" → 选择AnkiConnect → "配置"
- 默认设置：
  ```json
  {
    "apiKey": null,
    "apiLogPath": null,
    "webBindAddress": "127.0.0.1",
    "webBindPort": 8765,
    "webCorsOrigin": "http://localhost",
    "webCorsOriginList": ["http://localhost", "https://ankiuser.net"]
  }
  ```

### Anki集成使用
1. **确保Anki运行**：使用前请确保Anki软件已打开并运行
2. **导出生词**：在生词表中点击"📤 Anki"按钮
3. **自动同步**：插件会直接将生词添加到Anki中，无需手动导入CSV
4. **音频卡片**：生成的Anki卡片包含中英文发音功能：
   - 🔊 **自动播放**：卡片显示时自动播放发音
   - 👆 **点击播放**：点击音频区域手动播放发音
   - 🎨 **美观界面**：包含详细释义、例句和同义词
   - 📱 **跨平台**：支持Anki桌面版、AnkiDroid、AnkiMobile
5. **开始学习**：利用Anki的间隔重复算法进行高效记忆

#### 备用方案：CSV导出
如果AnkiConnect连接失败，插件会自动切换到CSV导出模式：
1. **下载CSV**：系统自动下载vocabulary_日期.csv文件
2. **手动导入**：在Anki中选择"文件→导入"，选择CSV文件

### 插件设置
- 点击浏览器工具栏中的插件图标
- 可以开启/关闭翻译功能
- 可以开启/关闭自动发音功能
- 可以选择翻译服务（Google/OpenAI）

### 翻译服务配置

#### Google翻译（默认）
- 无需配置，免费使用
- 提供基础翻译和简单例句

#### OpenAI翻译
- 需要配置API密钥、服务地址和模型
- 支持GPT模型，生成自然流畅的例句
- 兼容多种OpenAI API服务商

> 详细配置方法请参考 [OPENAI_SETUP.md](OPENAI_SETUP.md)

## 技术实现

- **翻译API**：使用Google翻译的免费API
- **语音合成**：使用浏览器内置的Web Speech API
- **数据存储**：使用Chrome存储API保存设置和生词表
- **缓存机制**：使用Map对象缓存翻译结果
- **响应式设计**：适配不同屏幕尺寸

## 文件结构

```
├── manifest.json      # 插件配置文件
├── content.js         # 内容脚本（翻译和生词表功能）
├── popup.html         # 弹出窗口HTML（设置和生词表界面）
├── popup.js           # 弹出窗口脚本
├── styles.css         # 样式文件
├── test.html          # 测试页面
└── README.md          # 说明文档
```

## 更新日志

### v1.4.0 (最新)
- 🎵 **Anki音频卡片**：生成的Anki卡片包含中英文发音功能
- 🔊 **自动播放**：卡片显示时延迟500ms自动播放发音
- 👆 **点击播放**：点击🔊按钮手动播放发音
- 🎨 **美观音频控件**：圆形播放按钮，中文橙色，英文蓝色
- 📱 **跨平台兼容**：支持Anki桌面版、AnkiDroid、AnkiMobile
- 🎵 **多语言TTS**：使用Google TTS生成高质量中英文音频

### v1.3.0
- 📝 **新增英文例句功能**：显示单词在实际语境中的使用
- 🔤 **中文例句翻译**：提供对应的中文翻译帮助理解
- 🤖 **多翻译服务支持**：集成OpenAI翻译服务
- 🎨 **优化界面设计**：例句以卡片形式美观展示
- 📱 **响应式适配**：更好地适配各种屏幕尺寸

### v1.2.0
- 📤 新增Anki导出功能
- ✨ 支持将生词表导出为CSV格式
- 🎯 完美集成Anki间隔重复学习系统
- 📚 提供详细的Anki导入指南

### v1.1.0
- ✨ 新增生词表功能
- ✨ 支持收藏和管理不熟悉的单词
- 🎨 优化用户界面，添加标签页设计
- 🔧 改进翻译触发方式（从悬浮改为划词选择）
- 📱 支持最多保存500个生词

### v1.0.0
- 🎉 初始版本发布
- 🌐 基本的悬浮翻译功能
- 🔊 语音朗读功能
- ⚙️ 基础设置选项

## 故障排除

### Anki连接问题
如果遇到"Anki Connect连接失败"的提示：

1. **检查Anki是否运行**：确保Anki软件已打开
2. **检查AnkiConnect插件**：
   - 在Anki中点击"工具" → "插件"
   - 确认AnkiConnect插件已安装且已启用
   - 如果显示为禁用状态，请点击启用
3. **重启Anki**：关闭并重新打开Anki软件
4. **检查端口占用**：确保8765端口未被其他程序占用
5. **防火墙设置**：确保防火墙允许Anki访问网络
6. **使用备用方案**：如果仍无法连接，插件会自动使用CSV导出功能

### 常见问题
- **翻译不显示**：检查网络连接，某些网站可能因CSP策略限制功能
- **发音不工作**：确保浏览器允许音频播放，检查音量设置
- **生词表丢失**：生词表保存在浏览器本地，卸载插件会丢失数据
- **Anki卡片重复**：插件会自动检测重复单词，跳过已存在的卡片

## 注意事项

- 插件需要网络连接才能获取翻译结果
- 某些网站可能因为CSP策略限制翻译功能
- 生词表数据保存在浏览器本地，卸载插件会丢失数据
- 建议定期备份重要的生词表内容
- 使用Anki同步功能前请确保Anki软件正在运行

## 开发说明

如需修改或扩展功能：

1. 修改相应的JavaScript或CSS文件
2. 在Chrome扩展程序页面点击"重新加载"按钮
3. 刷新测试页面查看效果

## 浏览器兼容性

- Chrome 88+
- Edge 88+
- 其他基于Chromium的浏览器

## 许可证

MIT License - 可自由使用和修改